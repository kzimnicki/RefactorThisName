<html>
<head>
    <title>CC</title>
    <script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type='text/javascript'>

        var delay = 2000;

        var changeDelay = function(){
          delay = $('#delay').val();
          console.log(delay);

        };

        if (!window.WebSocket)
            alert("WebSocket not supported by this browser");

        function getKeyCode(ev) {
            if (window.event)
                return window.event.keyCode;
            return ev.keyCode;
        }

        var server = {
            connect : function(url) {
                this._ws = new WebSocket(url);
                this._ws.onopen = this._onopen;
                this._ws.onmessage = this._onmessage;
                this._ws.onclose = this._onclose;
            },

            _onopen : function() {
                server._send('Loading...');
            },

            _send : function(message) {
                if (this._ws)
                    this._ws.send(message);
            },

            send : function(text) {
                if (text != null && text.length > 0)
                    server._send(text);
            },

            _onmessage : function(m) {
                var date = new Date();
                setTimeout(function(){
                    console.log(m.data);
                    if (m.data) {
                        var data = JSON.parse(m.data);
                        $('#line1').text('');
                        $('#line2').text('');
                        $('#line1').text(data.l1);
                        $('#line2').text(data.l2);
                    }
                }, delay);
            },

            _onclose : function(m) {
                this._ws = null;
            }
        };


    </script>
    <style type='text/css'>
        div {
        border: 0px solid black;
        }

        body {
        background-color: black;
        }

        div#messageBox {
        padding: 16px;
        color: white;
        }

        div#input {
        clear: both;
        width: 40em;
        padding: 4px;
        background-color: #e0e0e0;
        border: 1px solid black;
        border-top: 0px
        }

        span {
        top:50%;
        }

        span.alert {
        font-style: italic;
        }
        span.text {
            font-size: 5.5vw;
            font-family: sans-serif;
        }
    </style>
</head>
<body>
    <div id='messageBox' style="text-align: center; display: table; height: 95%; width: 95%">
        <div style=" display:table-cell;   vertical-align: middle;">
            <span id="line1" class="text">1</span>
            <br />
            <span id="line2" class="text">2</span>
        </div>
    </div>
    <div>
        <button onclick="changeDelay()">Change time</button>
        <input id="delay" value="2000">
    </div>
</div>
<script type='text/javascript'>
        var loc = window.location, new_uri;
        if (loc.protocol === "https:") {
            new_uri = "wss:";
        } else {
            new_uri = "ws:";
        }
        new_uri += "//" + loc.host;
        new_uri += loc.pathname + "app/";
        server.connect(new_uri);
        //server.connect('ws://explain.cc:8888/app');
        $('#control').empty();
</script>

</body>
</html>
